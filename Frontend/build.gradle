buildscript {
  repositories {
    maven {
        url "https://plugins.gradle.org/m2/"
    }
  }
}

plugins {
  id "com.moowork.node" version "1.2.0"
}

version '0.0.1-SNAPSHOT'

node {
    download = true
}

jar {
  from('build/dist') {
    into 'static'
  }

  includeEmptyDirs = false
}

node {
  download = true
}

task webpack(type: NodeTask, dependsOn: 'npmInstall') {
  script = project.file('node_modules/.bin/webpack')
}

task webpackWatch(type: NodeTask, dependsOn: 'npmInstall') {
  script = project.file('node_modules/.bin/webpack')
  args = ['--watch', '--display-error-details']
}

task testReact(type: NpmTask, dependsOn: 'npmInstall') {
  args = ['run', 'test']
}

task testReactWatch(type: NpmTask, group: 'Verification', description: 'Same as testReact but watches for changes') {
  args = ['run', 'testWatch']
}

processResources.dependsOn 'webpack'
clean.delete << file('build')
test.dependsOn 'testReact'
